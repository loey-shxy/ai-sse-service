/* empty css             *//* empty css                  *//* empty css               *//* empty css              */import{d as P,r as U,a as y,U as E,s as R,t as q,v as B,o as d,x as c,f as s,b as o,u as k,g as i,y as g,A as N,h as S,i as T,e as b,j as $,k as A,l as M,p as K,m as Y,a1 as j,a2 as D,a3 as G,E as h}from"./index--bHfDvFW.js";import{_ as O}from"./email-IfN3rjnv.js";import{s as z,k as H,n as J}from"./index-F5iSPcyE.js";const L="/image/password.png",Q={class:"sign-form"},W=b("img",{src:O,alt:""},null,-1),X=b("img",{src:L,alt:""},null,-1),Z={key:0,class:"forget-password"},ee={key:1,class:"forget-password"},se={key:2,class:"service"},pe=P({__name:"sign-form",setup(oe){const{appContext:{config:{globalProperties:f}}}=$(),_=U(),t=y({username:"",password:"",passport:""}),x=y({username:[{required:!0,message:"Please enter the login username",trigger:"blur"}],password:[{required:!0,message:"Please enter the login password",trigger:"blur"}]}),w=E(),u=R(),a=q(()=>u.currentRoute.value.name==="sign-up"),V=async()=>{const{data:r,code:e,msg:p}=await z({...t,passport:"FRONT"});if(e===1e3){j({key:"token",token:`Friend ${r.token}`});const m=await H();if(D(m),G(),!w.query.redirect)u.push({name:"explore"});else{const n=w.query.redirect;u.push({path:decodeURIComponent(n)})}}else h({type:"error",message:p})},F=async()=>{const{code:r,msg:e}=await J({account:t.username,password:t.password});console.log(r,e),r===1e3?u.push({name:"email-auth"}):h({type:"error",message:e})},v=async r=>{r&&await r.validate(async e=>{e&&(a.value?F():V())})};return(r,e)=>{const p=A,m=M,n=B("router-link"),I=K,C=Y;return d(),c("div",Q,[s(C,{ref_key:"ruleFormRef",ref:_,model:t,rules:x,"label-position":"top","hide-required-asterisk":"",onKeyup:e[3]||(e[3]=S(T(l=>v(_.value),["prevent"]),["enter"]))},{default:o(()=>[s(m,{label:"Email",prop:"username"},{default:o(()=>[s(p,{modelValue:t.username,"onUpdate:modelValue":e[0]||(e[0]=l=>t.username=l),placeholder:"Please enter the login username"},{prefix:o(()=>[W]),_:1},8,["modelValue"])]),_:1}),s(m,{label:"Password",prop:"password"},{default:o(()=>[s(p,{modelValue:t.password,"onUpdate:modelValue":e[1]||(e[1]=l=>t.password=l),type:"password",placeholder:"Please enter the login password"},{prefix:o(()=>[X]),_:1},8,["modelValue"])]),_:1}),!a.value&&!k(f).$isMobile?(d(),c("div",Z,[s(n,{to:{name:"reset-password"}},{default:o(()=>[i("Forgot Your Password?")]),_:1})])):g("",!0),s(I,{type:"primary",class:"sign-button",onClick:e[2]||(e[2]=l=>v(_.value))},{default:o(()=>[i(N(a.value?"Sign Up":"Sign In"),1)]),_:1}),!a.value&&k(f).$isMobile?(d(),c("div",ee,[s(n,{to:{name:"reset-password"}},{default:o(()=>[i("Forgot Your Password?")]),_:1})])):g("",!0),a.value?(d(),c("div",se,[i(" By signing up, you agree to "),s(n,{to:{name:"terms-of-service"},class:"link-text"},{default:o(()=>[i("Terms of Service")]),_:1})])):g("",!0)]),_:1},8,["model","rules"])])}}});export{pe as _};
